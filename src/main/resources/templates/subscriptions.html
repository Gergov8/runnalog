<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscriptions - RUNNALOG</title>

    <!-- TailwindCSS CDN (jit) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: {
                            DEFAULT: '#D4AF37',
                            soft: '#E6C967',
                            light: '#F5E7C5'
                        }
                    },
                    fontFamily: {
                        poppins: ['Poppins', 'ui-sans-serif', 'system-ui', 'sans-serif'],
                        mont: ['Montserrat', 'ui-sans-serif', 'system-ui', 'sans-serif'],
                        roboCond: ['Roboto Condensed', 'ui-sans-serif', 'system-ui', 'sans-serif']
                    },
                    boxShadow: {
                        glow: '0 0 0 2px rgba(212,175,55,0.35), 0 8px 30px rgba(0,0,0,0.35)',
                        gold: '0 0 20px rgba(212,175,55,0.4)'
                    },
                    backdropBlur: {
                        xs: '2px'
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/css/subscriptions.css}">

</head>
<body>
<!-- Background elements -->
<div class="bg-layer">
    <img src="/images/background.png" alt="Background" />
</div>

<!-- Header -->
<header class="header">
    <div class="logo"><a href="/feed">RUNNALOG</a></div>
    <div class="header-actions">
        <div class="strides-balance-header">
            <span class="strides-amount-header" th:text="${stats.strides}">12,500</span>
            <span class="strides-label-header">Strides</span>
        </div>
        <a class="btn btn-primary" href="/feed">FEED</a>
    </div>
</header>

<!-- Main content -->
<main class="page">
    <section class="card">
        <h1 class="card-title">Choose Your Plan</h1>

        <div th:if="${param.error}"
             class="text-red-500 text-center mt-4 font-semibold">
            <p th:text="${param.error}"></p>
        </div>

        <p class="error-message" th:if="${errorMessage}"  th:text="${errorMessage}"></p>

        <div class="plans">
            <!-- Recreational Plan -->
            <form th:action="@{/subscriptions/purchase}" th:object="${subscriptionUpgradeRequest}" method="post" class="plan-card">
                <input type="hidden" name="type" value="RECREATIONAL">
                <div class="plan-title">Recreational</div>
                <div class="plan-price">Free</div>
                <ul class="plan-features">
                    <li>Default Plan</li>
                    <li>Track unlimited runs</li>
                    <li>Basic statistics</li>
                    <li>Community access</li>
                </ul>
                <div th:if="${userSub.type == T(com.gergov.runnaLog.subscription.model.SubscriptionType).RECREATIONAL}">
                    <p class="btn btn-outline">Current Plan</p>
                </div>
                <div th:if="${userSub.type == T(com.gergov.runnaLog.subscription.model.SubscriptionType).ELITE}">
                    <p class="btn btn-outline">Default plan</p>
                </div>
            </form>

            <!-- Elite Plan -->
            <form th:action="@{/subscriptions/purchase}" th:object="${subscriptionUpgradeRequest}" method="post" class="plan-card">
                <input type="hidden" name="type" value="ELITE">
                <div class="plan-title">Elite</div>
                <div class="plan-price">6000 STR / month</div>
                <ul class="plan-features">
                    <li>Comprehensive Ai coaching</li>
                    <li>Unlimited training plans</li>
                    <li>Personalized training recommendations</li>
                    <li>Early access to features</li>
                </ul>
                <div th:if="${userSub.type == T(com.gergov.runnaLog.subscription.model.SubscriptionType).RECREATIONAL}">
                    <button class="btn btn-primary" type="submit">Go Elite</button>
                </div>
                <div th:if="${userSub.type == T(com.gergov.runnaLog.subscription.model.SubscriptionType).ELITE}">
                    <p class="btn btn-outline">Current Plan</p>
                </div>
            </form>
        </div>
    </section>
</main>

<script>
    // Add subtle animations to plan cards
    document.addEventListener('DOMContentLoaded', function() {
        const planCards = document.querySelectorAll('.plan-card');

        planCards.forEach((card, index) => {
            // Add staggered animation
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';

            setTimeout(() => {
                card.style.transition = 'all 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 200);
        });

        // Add confirmation for subscription
        const forms = document.querySelectorAll('form');
        forms.forEach(form => {
            form.addEventListener('submit', function(e) {
                const planType = this.querySelector('input[name="planType"]').value;
                if (planType !== 'RECREATIONAL') {
                    if (!confirm(`Are you sure you want to subscribe to the ${planType} plan?`)) {
                        e.preventDefault();
                    }
                }
            });
        });
    });
</script>
</body>
</html>